(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e9dc5e2"],{4299:function(t,a,n){"use strict";n("a7b9")},a7b9:function(t,a,n){},f483:function(t,a,n){"use strict";n.r(a);n("7f7f");var i=function(){var t=this,a=t._self._c;return a("div",{staticClass:"bg-white px-3",staticStyle:{margin:"-20px","margin-top":"-1rem","margin-bottom":"0!important"}},[a("div",{staticClass:"py-2 border-bottom d-flex align-items-center"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.createTop}},[t._v("创建顶级分类")])],1),a("el-tree",{attrs:{data:t.data,props:t.defaultProps,"default-expand-all":"","expand-on-click-node":!1,draggable:""},on:{"node-click":t.handleNodeClick,"node-drop":t.nodeDrop,"node-drag-end":t.nodeDragEnd},scopedSlots:t._u([{key:"default",fn:function(n){var i=n.node,e=n.data;return a("span",{staticClass:"custom-tree-node"},[a("div",[e.editStatus?a("el-input",{attrs:{size:"mini"},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"data.name"}}):a("span",[t._v(t._s(i.label))])],1),a("span",[a("el-button",{attrs:{type:e.status?"primary":"danger",size:"mini"},on:{click:function(a){return a.stopPropagation(),t.showOrHide(e)}}},[t._v("\n\t\t\t\t\t"+t._s(e.status?"显示":"隐藏")+"\n\t\t\t\t")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return t.append(e)}}},[t._v("增加")]),a("el-button",{attrs:{type:e.editStatus?"default":"warning",size:"mini"},on:{click:function(a){return t.edit(e)}}},[t._v(t._s(e.editStatus?"完成":"修改"))]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.remove(i,e)}}},[t._v("删除")])],1)])}}])})],1)},e=[],o=(n("ac6a"),{inject:["layout"],data:function(){return{data:[],defaultProps:{children:"child",label:"name"}}},created:function(){this.__init()},computed:{sortData:function(){var t=[],a=function a(n){n.forEach((function(n){t.push(n),n.child.length&&a(n.child)}))};return a(this.data),t=t.map((function(t,a){return{id:t.id,order:a,category_id:t.category_id}})),t}},methods:{__init:function(){var t=this;this.layout.showLoading(),this.axios.get("/admin/category",{token:!0}).then((function(a){var n=a.data.data,i=function t(a){a.forEach((function(a){a.editStatus=!1,a.child.length&&t(a.child)}))};i(n),t.data=n,t.layout.hideLoading()})).catch((function(a){t.layout.hideLoading()}))},handleNodeClick:function(t){console.log(t)},showOrHide:function(t){var a=this;this.layout.showLoading();var n=t.status?0:1,i=n?"显示":"隐藏";this.axios.post("/admin/category/"+t.id+"/update_status",{status:n},{token:!0}).then((function(e){t.status=n,a.layout.hideLoading(),a.$message({message:i+"成功",type:"success"})})).catch((function(t){a.layout.hideLoading()}))},edit:function(t){var a=this;return t.editStatus?""==t.name?this.$message({message:"分类名称不能为空",type:"error"}):(this.layout.showLoading(),void this.axios.post("/admin/category/"+t.id,{status:t.status,name:t.name,category_id:t.category_id},{token:!0}).then((function(n){a.$message({message:"修改成功",type:"success"}),t.editStatus=!1,a.layout.hideLoading()})).catch((function(t){a.layout.hideLoading()}))):t.editStatus=!0},remove:function(t,a){var n=this;this.$confirm("此操作将删除该分类, 是否继续?","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then((function(){n.layout.showLoading(),n.axios.delete("/admin/category/"+a.id,{token:!0}).then((function(t){n.__init(),n.$message({message:"删除成功",type:"success"}),n.layout.hideLoading()})).catch((function(t){n.layout.hideLoading()}))}))},append:function(t){var a=this;this.layout.showLoading(),this.axios.post("/admin/category",{status:0,name:"新分类",category_id:t.id},{token:!0}).then((function(n){var i=n.data.data;i.editStatus=!0,i.child=[],t.child.push(i),a.layout.hideLoading()})).catch((function(t){a.layout.hideLoading()}))},nodeDragEnd:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];var i=a[0].data,e=a[1].data;e&&("before"===a[2]||"after"===a[2]?i.category_id=e.category_id:i.category_id=e.id)},nodeDrop:function(){var t=this;this.layout.showLoading(),this.axios.post("/admin/category/sort",{sortdata:JSON.stringify(this.sortData)},{token:!0}).then((function(a){t.__init(),t.layout.hideLoading()})).catch((function(a){t.layout.hideLoading()}))},createTop:function(){var t=this;this.$prompt("请输入顶级分类名称","提示",{confirmButtonText:"创建",cancelButtonText:"取消",inputValidator:function(t){return""!==t&&null!==t||"顶级分类名称不能为空"}}).then((function(a){var n=a.value;t.layout.showLoading(),t.axios.post("/admin/category",{status:0,category_id:0,name:n},{token:!0}).then((function(a){t.__init(),t.$message({message:"创建成功",type:"success"}),t.layout.hideLoading()})).catch((function(a){t.layout.hideLoading()}))}))}}}),s=o,d=(n("4299"),n("2877")),c=Object(d["a"])(s,i,e,!1,null,null,null);a["default"]=c.exports}}]);
//# sourceMappingURL=chunk-0e9dc5e2.0770a6ba.js.map